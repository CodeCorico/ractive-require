/*! Ractive-Require (0.1.1). (C) 2015 Xavier Boubert. MIT @license: en.wikipedia.org/wiki/MIT_License */
!function(){"use strict";var e;e="undefined"!=typeof XMLHttpRequest?function(e){return new window.Ractive.Promise(function(t,n){var i,r,o;i=new XMLHttpRequest,i.open("GET",e),r=function(){4!==i.readyState||o||(t(i.responseText),o=!0)},i.onload=i.onreadystatechange=r,i.onerror=n,i.send(),4===i.readyState&&r()})}:function(e){return new window.Ractive.Promise(function(t,n){require("fs").readFile(e,function(e,i){return e?n(e):void t(i.toString())})})},window.Ractive.getHtml=e}(),function(){"use strict";function e(t,n,i,r,o,a){a=a||0,a<t.length&&t[a](n,i,r,o,function(){e(t,n,i,r,o,++a)})}var t={};window.Ractive.controller=function(e,n){t[e]=t[e]||[],"function"==typeof n&&t[e].push(n)},window.Ractive.fireController=function(n,i,r,o,a){t[n]&&e(t[n],i,r,o,a)}}(),function(){"use strict";function e(e,t){var n=e.getAttribute("src")||!1,r=e.getAttribute("target");return r?n?void window.Ractive.getHtml(n).then(function(e){e=i(e,n),t(r,e)}):void t(r,e.innerHTML):t(!1)}function t(t,n){return new window.Ractive.Promise(function(i){var r,o={},a=t.querySelectorAll("rv-partial"),u=a.length;for(r in n.partials)o[r]=n.partials[r];return u?void Array.prototype.map.call(a,function(t){e(t,function(e,t){e&&(o[e]=t),--u,1>u&&i(o)})}):i(o)})}function n(e,t){for(var n,i,r={},o={},a=0;a<e.attributes.length;a++)n=e.attributes[a],0===n.name.indexOf("data-bind-")?(i=n.name.substr(10,n.name.length-10),r[i]=t.get(n.value),o[i]=n.value):0===n.name.indexOf("data-")&&(i=n.name.substr(5,n.name.length-5),r[i]=n.value);return{data:r,binds:o}}function i(e,t){var n=t.split("/"),i=document.createElement("a"),r=window.location.protocol+"//"+window.location.host;return e.replace(/[^-]src="(.*?)"/g,function(e,t){return 0===t.indexOf("{")||0===t.indexOf("/")||0===t.indexOf("http://")||0===t.indexOf("https://")?e:(n.pop(),n.push(t),i.href=n.join("/"),e.replace(t,i.href.substr(r.length,i.href.length-r.length)))})}function r(e,t,n,i){return e.observe(i,function(e){t.set(n,e)})}function o(e,a,u,c,d){c=c||!1;var l=a.getAttribute("src"),s=a.getAttribute("name"),f=c||"true"==a.getAttribute("no-script"),w=d||"true"==a.getAttribute("no-css");if(!l)throw new Error('nv-require needs to have a "src" attrbute');if(!s)throw new Error('nv-require needs to have a "name" attrbute');if(a.setAttribute("loaded","true"),!window.Ractive.templates[s])return f?w?void window.Ractive.getHtml(l+".html").then(function(t){t=i(t,l),window.Ractive.templates[s]=t,o(e,a,u)}):window.Ractive.require(l+".css").then(function(){o(e,a,u,f,!0)}):window.Ractive.require(l+".js").then(function(){o(e,a,u,!0,w)});var v=window.Ractive.templates[s],p=n(a,e);t(a,e).then(function(t){a.innerHTML="",window.Ractive.fireController(s,function(n){if(n=n||{},n.el=n.el||a,n.template=n.template||v,n.partials){var i;for(i in n.partials)t[i]=n.partials[i]}n.partials=t,n.parentRequire=e;var o,u=new window.Ractive(n),c=[];for(o in p.binds)c.push(r(e,u,o,p.binds[o]));return u.on("teardown",function(){u.parentRequire=null;var t;for(t=0;t<c.length;t++)c[t].cancel();if(c=null,e&&e.childrenRequire)for(t=0;t<e.childrenRequire.length;t++)if(e.childrenRequire[t]===u){e.childrenRequire.splice(t,1);break}if(u.childrenRequire)for(t=u.childrenRequire.length-1;t>=0;t--)u.childrenRequire[t].teardown()}),u.childrenRequire=[],e.childrenRequire.push(u),u},p.data,a,{template:v,partials:t}),u&&u()})}function a(e,t){return e.parentNode!=t?"rv-require"==e.parentNode.tagName.toLowerCase()?!1:a(e.parentNode,t):!0}function u(e,t,n,i){if(e=e.split("/").pop(),window.Ractive.injects.indexOf(e)>-1)return i();var r=n();r.onload=i,window.Ractive.injects.push(e),document.getElementsByTagName("head")[0].appendChild(r)}function c(e,t,n){u(e,t,function(){var e=document.createElement("script");return e.type="text/javascript",e.src=t,e},n)}function d(e,t,n){u(e,t,function(){var e=document.createElement("link");return e.rel="stylesheet",e.href=t,e},n)}window.Ractive.templates=window.Ractive.templates||{},window.Ractive.injects=window.Ractive.injects||[],window.Ractive.require=function(e,t){var n=null;if(!e)throw new Error("You have to specify a file/name");return t=t||e,n=(t.split(".").pop()||"").toLowerCase(),"js"==n?new window.Ractive.Promise(function(n){c(e,t,n)}):"css"==n?new window.Ractive.Promise(function(n){d(e,t,n)}):void 0},window.Ractive.prototype.require=function(e){e=e||null;var t=this;return this.childrenRequire=this.childrenRequire||[],new window.Ractive.Promise(function(n){var i=t.findAll(e?'rv-require[src][ondemand="'+e+'"]:not([loaded="true"])':'rv-require[src]:not([loaded="true"]):not([ondemand])'),r=i.length;return 1>r?n():void i.forEach(function(e){a(e,t.el)&&o(t,e,function(){--r,1>r&&n()})})})}}();
//# sourceMappingURL=ractive-require.min.js.map