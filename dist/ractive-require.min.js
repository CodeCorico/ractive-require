/*! Ractive-Require (0.5.4). (C) 2015 CodeCorico. MIT @license: en.wikipedia.org/wiki/MIT_License */
!function(){"use strict";var e;e="undefined"!=typeof XMLHttpRequest?function(e){return new window.Ractive.Promise(function(n,t){var r,i,o;r=new XMLHttpRequest,r.open("GET",e),i=function(){4!==r.readyState||o||(n(r.responseText),o=!0)},r.onload=r.onreadystatechange=i,r.onerror=t,r.send(),4===r.readyState&&i()})}:function(e){return new window.Ractive.Promise(function(n,t){require("fs").readFile(e,function(e,r){return e?t(e):void n(r.toString())})})},window.Ractive.getHtml=e}(),function(){"use strict";function e(n,t,r,i,o,u,a){u<n.length?n[u](t,r,i,o,function(){e(n,t,r,i,o,++u,a)}):a&&a()}var n={};window.Ractive.controller=function(e,t){n[e]=n[e]||[],"function"==typeof t&&n[e].push(t)},window.Ractive.fireController=function(t,r,i,o,u,a,c){c=c===!1?c:(c||0)+1,n[t]?e(n[t],r,i,o,u,0,a):c!==!1&&500>c?setTimeout(function(){window.Ractive.fireController(t,r,i,o,u,a,c)},10):a&&a()}}(),function(){"use strict";function e(e,n){var t=e.getAttribute("src")||!1,i=e.getAttribute("target");return i?t?void window.Ractive.getHtml(t).then(function(e){e=r(e,t),n(i,e)}):void n(i,e.innerHTML):n(!1)}function n(n,t){return new window.Ractive.Promise(function(r){var i,o={},u=n.querySelectorAll("rv-partial"),a=u.length;for(i in t.partials)o[i]=t.partials[i];return a?void Array.prototype.map.call(u,function(n){e(n,function(e,n){e&&(o[e]=n),--a,1>a&&r(o)})}):r(o)})}function t(e,n){for(var t,r,i={},o={},u=0;u<e.attributes.length;u++)t=e.attributes[u],0===t.name.indexOf("data-bind-")?(r=t.name.substr(10,t.name.length-10),i[r]=n.get(t.value),o[r]=t.value):0===t.name.indexOf("data-")&&(r=t.name.substr(5,t.name.length-5),i[r]=t.value);return{data:i,binds:o}}function r(e,n){var t=n.split("/"),r=document.createElement("a"),i=window.location.protocol+"//"+window.location.host;return e.replace(/[^-]src="(.*?)"/g,function(e,n){return 0===n.indexOf("{")||0===n.indexOf("/")||0===n.indexOf("http://")||0===n.indexOf("https://")?e:(t.pop(),t.push(n),r.href=t.join("/"),e.replace(n,r.href.substr(i.length,r.href.length-i.length)))})}function i(e,n,t,r){return e.observe(r,function(e){n.set(t,e)})}function o(e,n,t,r){var i=[];if(e.childrenRequire&&e.childrenRequire.length)for(var u=0;u<e.childrenRequire.length;u++){if(e.childrenRequire[u].el.getAttribute(n)==t){if(r)return e.childrenRequire[u];i.push(e.childrenRequire[u])}var a=o(e.childrenRequire[u],n,t,r);if(r&&a)return a;!r&&a.length&&(i=i.concat(a))}return r?null:i}function u(e,n,t,r){var i=[];if(e.parentRequire){if(e.parentRequire.el.getAttribute(n)==t){if(r)return e.parentRequire;i.push(e.parentRequire)}var o=u(e.parentRequire,n,t,r);if(r&&o)return o;!r&&o.length&&(i=i.concat(o))}return r?null:i}function a(e,n,t,r){var i=e.className||"",o=[];i.split(" ").map(function(e){e=e.trim(),!e||(t||r)&&e==n||o.push(e)}),t&&o.push(n),e.className=o.join(" ")}function c(e,n){a(e,n,!0)}function l(e,n){a(e,n,!1,!0)}function d(e,a,f,s,h){s=s||!1;var v=a.getAttribute("src"),w=a.getAttribute("name"),p=s||"true"==a.getAttribute("no-script"),R=h||"true"==a.getAttribute("no-css");if(!v)throw new Error('nv-require needs to have a "src" attrbute');if(!w)throw new Error('nv-require needs to have a "name" attrbute');if(a.setAttribute("loaded","true"),c(a,"rv-require-loaded"),!window.Ractive.templates[w])return R?p?void window.Ractive.getHtml(v+".html").then(function(n){n=r(n,v),window.Ractive.templates[w]=n,d(e,a,f)}):window.Ractive.require(v+".js").then(function(){d(e,a,f,!0,R)}):window.Ractive.require(v+".css").then(function(){d(e,a,f,p,!0)});var m=window.Ractive.templates[w],q=t(a,e),g=a.innerHTML;n(a,e).then(function(n){a.innerHTML="",window.Ractive.fireController(w,function(t){if(t=t||{},t.el=t.el||a,t.template=t.template||m,t.partials){var r;for(r in t.partials)n[r]=t.partials[r]}t.partials=n,t.parentRequire=e;var c,d=new window.Ractive(t),f=[];for(c in q.binds)f.push(i(e,d,c,q.binds[c])),f.push(i(d,e,q.binds[c],c));d.on("unrender",function(){a.removeAttribute("loaded"),l(a,"rv-require-loaded"),d.parentRequire=null;var n;if(f&&f.length)for(n=0;n<f.length;n++)f[n].cancel();if(f=null,e&&e.childrenRequire)for(n=0;n<e.childrenRequire.length;n++)if(e.childrenRequire[n]===d){e.childrenRequire.splice(n,1);break}if(d.childrenRequire&&d.childrenRequire.length)for(n=d.childrenRequire.length-1;n>=0;n--)d.childrenRequire[n].teardown()}),d.on("teardown",function(){a.innerHTML=g}),d.childrenRequire=[];var s=[d];return e.findParents||s.push(e),s.forEach(function(e){e.findParents=function(n,t){return u(e,n,t)},e.findParent=function(n,t){return u(e,n,t,!0)},e.findChildren=function(n,t){return o(e,n,t)},e.findChild=function(n,t){return o(e,n,t,!0)}}),e.childrenRequire.push(d),d},q.data,a,{template:m,partials:n},function(){f&&f()})})}function f(e,n){return e.parentNode!=n?"rv-require"==e.parentNode.tagName.toLowerCase()?!1:f(e.parentNode,n):!0}function s(e,n,t,r){if(e=e.split("/").pop(),window.Ractive.injects.indexOf(e)>-1)return r();var i=t();i.onload=r,window.Ractive.injects.push(e),document.getElementsByTagName("head")[0].appendChild(i)}function h(e,n,t){s(e,n,function(){var e=document.createElement("script");return e.type="text/javascript",e.src=n,e},t)}function v(e,n,t){s(e,n,function(){var e=document.createElement("link");return e.rel="stylesheet",e.href=n,e},t)}window.Ractive.templates=window.Ractive.templates||{},window.Ractive.injects=window.Ractive.injects||[],window.Ractive.require=function(e,n){var t=null;if(!e)throw new Error("You have to specify a file/name");return n=n||e,t=(n.split(".").pop()||"").toLowerCase(),"js"==t?new window.Ractive.Promise(function(t){h(e,n,t)}):"css"==t?new window.Ractive.Promise(function(t){v(e,n,t)}):void 0},window.Ractive.prototype.require=function(e){e=e||null;var n=this;return this.childrenRequire=this.childrenRequire||[],new window.Ractive.Promise(function(t){var r=e?n.el.querySelectorAll('rv-require[src][ondemand="'+e+'"]:not([loaded="true"])'):n.el.querySelectorAll('rv-require[src]:not([loaded="true"]):not([ondemand])'),i=r.length;return 1>i?t():void[].forEach.call(r,function(e){f(e,n.el)?d(n,e,function(){--i,1>i&&t()}):(--i,1>i&&t())})})}}();
//# sourceMappingURL=ractive-require.min.js.map